<%= render "shared/navbar" %>
<div class="container">
  <div class="row">

    <div style = "margin: 20px 0px; width:100%;box-shadow: 20px white;box-shadow: 3px 45px 1em #000000b5;z-index: 100">
      <h1>Check out all these events in your area</h1>
      <p><%= link_to "Create your own event", new_event_path %></p>
    </div>

    <div class="col-sm-5" id="main">
      <div>
        <% @events.each do |event| %>
          <%= link_to event_path(event) do %>

              <div style = "display: flex; align-items: center;" class = "event_card <%=event.category%>">

              <div>
                <%= image_tag "#{event.category}_photo.jpeg", style: "border-radius: 25px; width: 180px; padding: 20px"%>
              </div>

              <div>

                <p><%= event.attendees.count+1%> attending </p>
                <p style = "margin-bottom: 0px;">🗓 <%= event.start_time.strftime("%d of %B, %Y") %></p>
                <p style = "margin-bottom: 0px;">⏰ <%= event.start_time.strftime("%I:%M %p") %></p>
                <p>📍 <%= event.location %></p>
                <% if event.join_requests.find_by(user: current_user, event: event).nil? && event.user != current_user && event.attendees.count != event.capacity%>
                  <%= link_to 'Join', new_event_join_request_path(event), class:"joineventbtn mt-4 mb-3" %>

                <% else event.attendees.count == event.capacity %>
                  <p> full</p> <!-- Full Button comes here -->
                <% end %>

              </div>

              </div>
          <% end %>
        <% end %>
      </div>
    </div>

    <div class="col-sm-7" id="sticky sidebar">
      <div id="map" style="width: 100%; height: 100vh; border-radius: 5px; position: sticky; top: 0;"
        data-markers="<%= @markers.to_json %>"
        data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>
    </div>

  </div>
</div>
